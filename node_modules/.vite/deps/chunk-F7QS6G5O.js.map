{
  "version": 3,
  "sources": ["../../@vaadin/a11y-base/src/field-aria-controller.js"],
  "sourcesContent": ["/**\r\n * @license\r\n * Copyright (c) 2021 - 2025 Vaadin Ltd.\r\n * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/\r\n */\r\nimport { removeAriaIDReference, restoreGeneratedAriaIDReference, setAriaIDReference } from './aria-id-reference.js';\r\n\r\n/**\r\n * A controller for managing ARIA attributes for a field element:\r\n * either the component itself or slotted `<input>` element.\r\n */\r\nexport class FieldAriaController {\r\n  constructor(host) {\r\n    this.host = host;\r\n    this.__required = false;\r\n  }\r\n\r\n  /**\r\n   * Sets a target element to which ARIA attributes are added.\r\n   *\r\n   * @param {HTMLElement} target\r\n   */\r\n  setTarget(target) {\r\n    this.__target = target;\r\n    this.__setAriaRequiredAttribute(this.__required);\r\n    // We need to make sure that value in __labelId is stored\r\n    this.__setLabelIdToAriaAttribute(this.__labelId, this.__labelId);\r\n    if (this.__labelIdFromUser != null) {\r\n      this.__setLabelIdToAriaAttribute(this.__labelIdFromUser, this.__labelIdFromUser, true);\r\n    }\r\n    this.__setErrorIdToAriaAttribute(this.__errorId);\r\n    this.__setHelperIdToAriaAttribute(this.__helperId);\r\n    this.setAriaLabel(this.__label);\r\n  }\r\n\r\n  /**\r\n   * Toggles the `aria-required` attribute on the target element\r\n   * if the target is the host component (e.g. a field group).\r\n   * Otherwise, it does nothing.\r\n   *\r\n   * @param {boolean} required\r\n   */\r\n  setRequired(required) {\r\n    this.__setAriaRequiredAttribute(required);\r\n    this.__required = required;\r\n  }\r\n\r\n  /**\r\n   * Defines the `aria-label` attribute of the target element.\r\n   *\r\n   * To remove the attribute, pass `null` as `label`.\r\n   *\r\n   * @param {string | null | undefined} label\r\n   */\r\n  setAriaLabel(label) {\r\n    this.__setAriaLabelToAttribute(label);\r\n    this.__label = label;\r\n  }\r\n\r\n  /**\r\n   * Links the target element with a slotted label element\r\n   * via the target's attribute `aria-labelledby`.\r\n   *\r\n   * To unlink the previous slotted label element, pass `null` as `labelId`.\r\n   *\r\n   * @param {string | null} labelId\r\n   */\r\n  setLabelId(labelId, fromUser = false) {\r\n    const oldLabelId = fromUser ? this.__labelIdFromUser : this.__labelId;\r\n    this.__setLabelIdToAriaAttribute(labelId, oldLabelId, fromUser);\r\n    if (fromUser) {\r\n      this.__labelIdFromUser = labelId;\r\n    } else {\r\n      this.__labelId = labelId;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Links the target element with a slotted error element via the target's attribute:\r\n   * - `aria-labelledby` if the target is the host component (e.g a field group).\r\n   * - `aria-describedby` otherwise.\r\n   *\r\n   * To unlink the previous slotted error element, pass `null` as `errorId`.\r\n   *\r\n   * @param {string | null} errorId\r\n   */\r\n  setErrorId(errorId) {\r\n    this.__setErrorIdToAriaAttribute(errorId, this.__errorId);\r\n    this.__errorId = errorId;\r\n  }\r\n\r\n  /**\r\n   * Links the target element with a slotted helper element via the target's attribute:\r\n   * - `aria-labelledby` if the target is the host component (e.g a field group).\r\n   * - `aria-describedby` otherwise.\r\n   *\r\n   * To unlink the previous slotted helper element, pass `null` as `helperId`.\r\n   *\r\n   * @param {string | null} helperId\r\n   */\r\n  setHelperId(helperId) {\r\n    this.__setHelperIdToAriaAttribute(helperId, this.__helperId);\r\n    this.__helperId = helperId;\r\n  }\r\n\r\n  /**\r\n   * @param {string | null | undefined} label\r\n   * @private\r\n   * */\r\n  __setAriaLabelToAttribute(label) {\r\n    if (!this.__target) {\r\n      return;\r\n    }\r\n    if (label) {\r\n      removeAriaIDReference(this.__target, 'aria-labelledby');\r\n      this.__target.setAttribute('aria-label', label);\r\n    } else if (this.__label) {\r\n      restoreGeneratedAriaIDReference(this.__target, 'aria-labelledby');\r\n      this.__target.removeAttribute('aria-label');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {string | null | undefined} labelId\r\n   * @param {string | null | undefined} oldLabelId\r\n   * @param {boolean | null | undefined} fromUser\r\n   * @private\r\n   */\r\n  __setLabelIdToAriaAttribute(labelId, oldLabelId, fromUser) {\r\n    setAriaIDReference(this.__target, 'aria-labelledby', { newId: labelId, oldId: oldLabelId, fromUser });\r\n  }\r\n\r\n  /**\r\n   * @param {string | null | undefined} errorId\r\n   * @param {string | null | undefined} oldErrorId\r\n   * @private\r\n   */\r\n  __setErrorIdToAriaAttribute(errorId, oldErrorId) {\r\n    setAriaIDReference(this.__target, 'aria-describedby', { newId: errorId, oldId: oldErrorId, fromUser: false });\r\n  }\r\n\r\n  /**\r\n   * @param {string | null | undefined} helperId\r\n   * @param {string | null | undefined} oldHelperId\r\n   * @private\r\n   */\r\n  __setHelperIdToAriaAttribute(helperId, oldHelperId) {\r\n    setAriaIDReference(this.__target, 'aria-describedby', { newId: helperId, oldId: oldHelperId, fromUser: false });\r\n  }\r\n\r\n  /**\r\n   * @param {boolean} required\r\n   * @private\r\n   */\r\n  __setAriaRequiredAttribute(required) {\r\n    if (!this.__target) {\r\n      return;\r\n    }\r\n\r\n    if (['input', 'textarea'].includes(this.__target.localName)) {\r\n      // Native <input> or <textarea>, required is enough\r\n      return;\r\n    }\r\n\r\n    if (required) {\r\n      this.__target.setAttribute('aria-required', 'true');\r\n    } else {\r\n      this.__target.removeAttribute('aria-required');\r\n    }\r\n  }\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
