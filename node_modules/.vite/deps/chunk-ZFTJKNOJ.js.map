{
  "version": 3,
  "sources": ["../../@vaadin/a11y-base/src/delegate-focus-mixin.js"],
  "sourcesContent": ["/**\r\n * @license\r\n * Copyright (c) 2021 - 2025 Vaadin Ltd.\r\n * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/\r\n */\r\nimport { dedupingMixin } from '@polymer/polymer/lib/utils/mixin.js';\r\nimport { FocusMixin } from './focus-mixin.js';\r\nimport { TabindexMixin } from './tabindex-mixin.js';\r\n\r\n/**\r\n * A mixin to forward focus to an element in the light DOM.\r\n *\r\n * @polymerMixin\r\n * @mixes FocusMixin\r\n * @mixes TabindexMixin\r\n */\r\nexport const DelegateFocusMixin = dedupingMixin(\r\n  (superclass) =>\r\n    class DelegateFocusMixinClass extends FocusMixin(TabindexMixin(superclass)) {\r\n      static get properties() {\r\n        return {\r\n          /**\r\n           * Specify that this control should have input focus when the page loads.\r\n           */\r\n          autofocus: {\r\n            type: Boolean,\r\n          },\r\n\r\n          /**\r\n           * A reference to the focusable element controlled by the mixin.\r\n           * It can be an input, textarea, button or any element with tabindex > -1.\r\n           *\r\n           * Any component implementing this mixin is expected to provide it\r\n           * by using `this._setFocusElement(input)` Polymer API.\r\n           *\r\n           * Toggling `tabindex` attribute on the host element propagates its value to `focusElement`.\r\n           *\r\n           * @protected\r\n           * @type {!HTMLElement}\r\n           */\r\n          focusElement: {\r\n            type: Object,\r\n            readOnly: true,\r\n            observer: '_focusElementChanged',\r\n          },\r\n\r\n          /**\r\n           * Override the property from `TabIndexMixin`\r\n           * to ensure the `tabindex` attribute of the focus element\r\n           * will be restored to `0` after re-enabling the element.\r\n           *\r\n           * @protected\r\n           * @override\r\n           */\r\n          _lastTabIndex: {\r\n            value: 0,\r\n          },\r\n        };\r\n      }\r\n\r\n      constructor() {\r\n        super();\r\n\r\n        this._boundOnBlur = this._onBlur.bind(this);\r\n        this._boundOnFocus = this._onFocus.bind(this);\r\n      }\r\n\r\n      /** @protected */\r\n      ready() {\r\n        super.ready();\r\n\r\n        if (this.autofocus && !this.disabled) {\r\n          requestAnimationFrame(() => {\r\n            this.focus();\r\n            this.setAttribute('focus-ring', '');\r\n          });\r\n        }\r\n      }\r\n\r\n      /**\r\n       * @protected\r\n       * @override\r\n       */\r\n      focus() {\r\n        if (this.focusElement && !this.disabled) {\r\n          this.focusElement.focus();\r\n        }\r\n      }\r\n\r\n      /**\r\n       * @protected\r\n       * @override\r\n       */\r\n      blur() {\r\n        if (this.focusElement) {\r\n          this.focusElement.blur();\r\n        }\r\n      }\r\n\r\n      /**\r\n       * @protected\r\n       * @override\r\n       */\r\n      click() {\r\n        if (this.focusElement && !this.disabled) {\r\n          this.focusElement.click();\r\n        }\r\n      }\r\n\r\n      /** @protected */\r\n      _focusElementChanged(element, oldElement) {\r\n        if (element) {\r\n          element.disabled = this.disabled;\r\n          this._addFocusListeners(element);\r\n          this.__forwardTabIndex(this.tabindex);\r\n        } else if (oldElement) {\r\n          this._removeFocusListeners(oldElement);\r\n        }\r\n      }\r\n\r\n      /**\r\n       * @param {HTMLElement} element\r\n       * @protected\r\n       */\r\n      _addFocusListeners(element) {\r\n        element.addEventListener('blur', this._boundOnBlur);\r\n        element.addEventListener('focus', this._boundOnFocus);\r\n      }\r\n\r\n      /**\r\n       * @param {HTMLElement} element\r\n       * @protected\r\n       */\r\n      _removeFocusListeners(element) {\r\n        element.removeEventListener('blur', this._boundOnBlur);\r\n        element.removeEventListener('focus', this._boundOnFocus);\r\n      }\r\n\r\n      /**\r\n       * Focus event does not bubble, so we dispatch it manually\r\n       * on the host element to support adding focus listeners\r\n       * when the focusable element is placed in light DOM.\r\n       * @param {FocusEvent} event\r\n       * @protected\r\n       */\r\n      _onFocus(event) {\r\n        event.stopPropagation();\r\n        this.dispatchEvent(new Event('focus'));\r\n      }\r\n\r\n      /**\r\n       * Blur event does not bubble, so we dispatch it manually\r\n       * on the host element to support adding blur listeners\r\n       * when the focusable element is placed in light DOM.\r\n       * @param {FocusEvent} event\r\n       * @protected\r\n       */\r\n      _onBlur(event) {\r\n        event.stopPropagation();\r\n        this.dispatchEvent(new Event('blur'));\r\n      }\r\n\r\n      /**\r\n       * @param {FocusEvent} event\r\n       * @return {boolean}\r\n       * @protected\r\n       * @override\r\n       */\r\n      _shouldSetFocus(event) {\r\n        return event.target === this.focusElement;\r\n      }\r\n\r\n      /**\r\n       * @param {FocusEvent} event\r\n       * @return {boolean}\r\n       * @protected\r\n       * @override\r\n       */\r\n      _shouldRemoveFocus(event) {\r\n        return event.target === this.focusElement;\r\n      }\r\n\r\n      /**\r\n       * @param {boolean} disabled\r\n       * @param {boolean} oldDisabled\r\n       * @protected\r\n       * @override\r\n       */\r\n      _disabledChanged(disabled, oldDisabled) {\r\n        super._disabledChanged(disabled, oldDisabled);\r\n\r\n        if (this.focusElement) {\r\n          this.focusElement.disabled = disabled;\r\n        }\r\n\r\n        if (disabled) {\r\n          this.blur();\r\n        }\r\n      }\r\n\r\n      /**\r\n       * Override an observer from `TabindexMixin`.\r\n       * Do not call super to remove tabindex attribute\r\n       * from the host after it has been forwarded.\r\n       * @param {string} tabindex\r\n       * @protected\r\n       * @override\r\n       */\r\n      _tabindexChanged(tabindex) {\r\n        this.__forwardTabIndex(tabindex);\r\n      }\r\n\r\n      /** @private */\r\n      __forwardTabIndex(tabindex) {\r\n        if (tabindex !== undefined && this.focusElement) {\r\n          this.focusElement.tabIndex = tabindex;\r\n\r\n          // Preserve tabindex=\"-1\" on the host element\r\n          if (tabindex !== -1) {\r\n            this.tabindex = undefined;\r\n          }\r\n        }\r\n\r\n        if (this.disabled && tabindex) {\r\n          // If tabindex attribute was changed while component was disabled\r\n          if (tabindex !== -1) {\r\n            this._lastTabIndex = tabindex;\r\n          }\r\n          this.tabindex = undefined;\r\n        }\r\n      }\r\n    },\r\n);\r\n"],
  "mappings": "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",
  "names": []
}
