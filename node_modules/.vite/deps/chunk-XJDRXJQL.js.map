{
  "version": 3,
  "sources": ["../../@vaadin/component-base/src/overflow-controller.js"],
  "sourcesContent": ["/**\r\n * @license\r\n * Copyright (c) 2021 - 2025 Vaadin Ltd.\r\n * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/\r\n */\r\nimport { animationFrame } from './async.js';\r\nimport { Debouncer } from './debounce.js';\r\n\r\n/**\r\n * A controller that detects if content inside the element overflows its scrolling viewport,\r\n * and sets the `overflow` attribute on the host with a value that indicates the directions\r\n * where content is overflowing. Supported values are: `top`, `bottom`, `start`, `end`.\r\n */\r\nexport class OverflowController {\r\n  constructor(host, scrollTarget) {\r\n    /**\r\n     * The controller host element.\r\n     *\r\n     * @type {HTMLElement}\r\n     */\r\n    this.host = host;\r\n\r\n    /**\r\n     * The element that wraps scrollable content.\r\n     * If not set, the host element is used.\r\n     *\r\n     * @type {HTMLElement}\r\n     */\r\n    this.scrollTarget = scrollTarget || host;\r\n\r\n    /** @private */\r\n    this.__boundOnScroll = this.__onScroll.bind(this);\r\n  }\r\n\r\n  hostConnected() {\r\n    if (!this.initialized) {\r\n      this.initialized = true;\r\n\r\n      this.observe();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Setup scroll listener and observers to update overflow.\r\n   * Also performs one-time update synchronously when called.\r\n   * @protected\r\n   */\r\n  observe() {\r\n    const { host } = this;\r\n\r\n    this.__resizeObserver = new ResizeObserver(() => {\r\n      this.__debounceOverflow = Debouncer.debounce(this.__debounceOverflow, animationFrame, () => {\r\n        this.__updateOverflow();\r\n      });\r\n    });\r\n\r\n    this.__resizeObserver.observe(host);\r\n\r\n    // Observe initial children\r\n    [...host.children].forEach((child) => {\r\n      this.__resizeObserver.observe(child);\r\n    });\r\n\r\n    this.__childObserver = new MutationObserver((mutations) => {\r\n      mutations.forEach(({ addedNodes, removedNodes }) => {\r\n        addedNodes.forEach((node) => {\r\n          if (node.nodeType === Node.ELEMENT_NODE) {\r\n            this.__resizeObserver.observe(node);\r\n          }\r\n        });\r\n\r\n        removedNodes.forEach((node) => {\r\n          if (node.nodeType === Node.ELEMENT_NODE) {\r\n            this.__resizeObserver.unobserve(node);\r\n          }\r\n        });\r\n      });\r\n\r\n      this.__updateOverflow();\r\n    });\r\n\r\n    this.__childObserver.observe(host, { childList: true });\r\n\r\n    // Update overflow attribute on scroll\r\n    this.scrollTarget.addEventListener('scroll', this.__boundOnScroll);\r\n\r\n    this.__updateOverflow();\r\n  }\r\n\r\n  /** @private */\r\n  __onScroll() {\r\n    this.__updateOverflow();\r\n  }\r\n\r\n  /** @private */\r\n  __updateOverflow() {\r\n    const target = this.scrollTarget;\r\n\r\n    let overflow = '';\r\n\r\n    if (target.scrollTop > 0) {\r\n      overflow += ' top';\r\n    }\r\n\r\n    if (Math.ceil(target.scrollTop) < Math.ceil(target.scrollHeight - target.clientHeight)) {\r\n      overflow += ' bottom';\r\n    }\r\n\r\n    const scrollLeft = Math.abs(target.scrollLeft);\r\n    if (scrollLeft > 0) {\r\n      overflow += ' start';\r\n    }\r\n\r\n    if (Math.ceil(scrollLeft) < Math.ceil(target.scrollWidth - target.clientWidth)) {\r\n      overflow += ' end';\r\n    }\r\n\r\n    overflow = overflow.trim();\r\n    if (overflow.length > 0 && this.host.getAttribute('overflow') !== overflow) {\r\n      this.host.setAttribute('overflow', overflow);\r\n    } else if (overflow.length === 0 && this.host.hasAttribute('overflow')) {\r\n      this.host.removeAttribute('overflow');\r\n    }\r\n  }\r\n}\r\n"],
  "mappings": ";;;;;;;;AAaO,IAAM,qBAAN,MAAyB;AAAA,EAC9B,YAAY,MAAM,cAAc;AAM9B,SAAK,OAAO;AAQZ,SAAK,eAAe,gBAAgB;AAGpC,SAAK,kBAAkB,KAAK,WAAW,KAAK,IAAI;AAAA,EAClD;AAAA,EAEA,gBAAgB;AACd,QAAI,CAAC,KAAK,aAAa;AACrB,WAAK,cAAc;AAEnB,WAAK,QAAQ;AAAA,IACf;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,UAAU;AACR,UAAM,EAAE,KAAK,IAAI;AAEjB,SAAK,mBAAmB,IAAI,eAAe,MAAM;AAC/C,WAAK,qBAAqB,UAAU,SAAS,KAAK,oBAAoB,gBAAgB,MAAM;AAC1F,aAAK,iBAAiB;AAAA,MACxB,CAAC;AAAA,IACH,CAAC;AAED,SAAK,iBAAiB,QAAQ,IAAI;AAGlC,KAAC,GAAG,KAAK,QAAQ,EAAE,QAAQ,CAAC,UAAU;AACpC,WAAK,iBAAiB,QAAQ,KAAK;AAAA,IACrC,CAAC;AAED,SAAK,kBAAkB,IAAI,iBAAiB,CAAC,cAAc;AACzD,gBAAU,QAAQ,CAAC,EAAE,YAAY,aAAa,MAAM;AAClD,mBAAW,QAAQ,CAAC,SAAS;AAC3B,cAAI,KAAK,aAAa,KAAK,cAAc;AACvC,iBAAK,iBAAiB,QAAQ,IAAI;AAAA,UACpC;AAAA,QACF,CAAC;AAED,qBAAa,QAAQ,CAAC,SAAS;AAC7B,cAAI,KAAK,aAAa,KAAK,cAAc;AACvC,iBAAK,iBAAiB,UAAU,IAAI;AAAA,UACtC;AAAA,QACF,CAAC;AAAA,MACH,CAAC;AAED,WAAK,iBAAiB;AAAA,IACxB,CAAC;AAED,SAAK,gBAAgB,QAAQ,MAAM,EAAE,WAAW,KAAK,CAAC;AAGtD,SAAK,aAAa,iBAAiB,UAAU,KAAK,eAAe;AAEjE,SAAK,iBAAiB;AAAA,EACxB;AAAA;AAAA,EAGA,aAAa;AACX,SAAK,iBAAiB;AAAA,EACxB;AAAA;AAAA,EAGA,mBAAmB;AACjB,UAAM,SAAS,KAAK;AAEpB,QAAI,WAAW;AAEf,QAAI,OAAO,YAAY,GAAG;AACxB,kBAAY;AAAA,IACd;AAEA,QAAI,KAAK,KAAK,OAAO,SAAS,IAAI,KAAK,KAAK,OAAO,eAAe,OAAO,YAAY,GAAG;AACtF,kBAAY;AAAA,IACd;AAEA,UAAM,aAAa,KAAK,IAAI,OAAO,UAAU;AAC7C,QAAI,aAAa,GAAG;AAClB,kBAAY;AAAA,IACd;AAEA,QAAI,KAAK,KAAK,UAAU,IAAI,KAAK,KAAK,OAAO,cAAc,OAAO,WAAW,GAAG;AAC9E,kBAAY;AAAA,IACd;AAEA,eAAW,SAAS,KAAK;AACzB,QAAI,SAAS,SAAS,KAAK,KAAK,KAAK,aAAa,UAAU,MAAM,UAAU;AAC1E,WAAK,KAAK,aAAa,YAAY,QAAQ;AAAA,IAC7C,WAAW,SAAS,WAAW,KAAK,KAAK,KAAK,aAAa,UAAU,GAAG;AACtE,WAAK,KAAK,gBAAgB,UAAU;AAAA,IACtC;AAAA,EACF;AACF;",
  "names": []
}
